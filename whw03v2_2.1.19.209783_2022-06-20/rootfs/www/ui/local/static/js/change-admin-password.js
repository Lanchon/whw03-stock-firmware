$(document).ready(function(){var h=RAINIER.ui.buildInputValidBalloon,b=false,g=RAINIER.shared.util.getCookie("reset-code"),e=lodash.startsWith(g,"force-update"),i=g==="force-update-welcome",c;function f(){if(!a()){return}var l=b?"/jnap/nodes/setup/SetAdminPassword2":"/jnap/nodes/setup/SetAdminPassword";var k={resetCode:g,adminPassword:$("#routerPassword").val(),passwordHint:$("#passwordHint").val()};if(!k.resetCode){window.location.replace("/ui/dynamic/index.html");return}if(e){l=b?"/jnap/core/SetAdminPassword2":"/jnap/core/SetAdminPassword";$.delAttr(k,"resetCode");if(!b){$.delAttr(k,"passwordHint")}}RAINIER.ui.wait();RAINIER.jnap.send({action:l,data:k,cb:function(n,m){if(n&&n.result==="OK"){RAINIER.shared.util.deleteCookie("reset-code");if(i){RAINIER.shared.util.deleteCookie("admin-auth");RAINIER.network.setRemoteSetting(true,function(){window.location.replace("welcome.html")})}else{RAINIER.shared.util.setCookie("admin-auth","Basic "+window.btoa("admin:"+k.adminPassword),null,"/");RAINIER.shared.util.setCookie("admin-password-reset",true,null,"/");RAINIER.shared.util.deleteCookie("user-auth-token");RAINIER.shared.util.deleteCookie("current-network-id");RAINIER.network.setRemoteSetting(false,function(){window.location.replace("/")})}}},useAdminAuth:true,forceLocal:true})}function d(){c={password:h($.extend(true,{},{els:$("#routerPassword"),validationType:"newRouterPassword",isChecklist:true,noWarnIcon:true},RAINIER.network.getRouterPasswordOptions())),passwordVisible:h($.extend(true,{},{els:$("#routerPasswordText"),validationType:"newRouterPassword",isChecklist:true,noWarnIcon:true},RAINIER.network.getRouterPasswordOptions())),hint:h($.extend(true,{},{els:$("#passwordHint"),validationType:"routerPasswordHint",maxLen:512,elCompareTo:$("#routerPassword")}))}}function a(){var k=true;if($("#routerPassword").is(":visible")){k=c.password.isValid();if(!k){c.password.isValid(true);$("#routerPassword").blur().focus()}}else{k=c.passwordVisible.isValid();if(!k){c.password.isValid(true);$("#routerPasswordText").blur().focus()}}if(k){k=c.hint.isValid(true);if(!k){$("#passwordHint").blur().focus()}}return k}function j(){$("#applet-container").css("visibility","visible");window.onbeforeunload=function(){RAINIER.shared.util.deleteCookie("reset-code")};RAINIER.network.getDeviceInfo(function(){b=RAINIER.shared.util.areServicesSupported(["/jnap/core/Core7"]);if(!b){$("#passwordHint").hide()}$("#submit").click(f);$("textarea").val("");RAINIER.ui.init();RAINIER.ui.associateButtons("#routerPassword, #passwordHint","#submit");d();RAINIER.ui.viewPassword($(".password-eye-box"))})}j()});