(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","lodash","md5","./symmetry-jnap","./channel-data"],b)}else{if(typeof module==="object"&&module.exports){module.exports=b(require("jquery"),require("lodash"),require("blueimp-md5"),require("./symmetry-jnap"),require("./channel-data"))}else{a.utilWireless=b(a.$,(a.lodash||a._),a.md5,a.JNAP,a.channelLookupData)}}}(this,function(h,D,g,t,C){var v;var q=["supportedBandSteeringModes"];var f=["isEnabled","mode","broadcastSSID","channelWidth","channel"];var d=[{modelNumbers:["EA9200","EA9300","EA9400","EA9500"],supportedModes:[{mode:"Basic",primaryRadioID:"RADIO_5GHz"}],radioDefaults:[{radioID:"RADIO_5GHz",steeredModes:["Basic"],settings:{mode:"802.11anac",channel:36,channelWidth:"Wide80"}},{radioID:"RADIO_5GHz_2",steeredModes:["Basic"],settings:{mode:"802.11anac",channel:161,channelWidth:"Wide80"}}]},{modelNumbers:["EA8300","EA8250"],supportedModes:[{mode:"Basic",primaryRadioID:"RADIO_5GHz"},{mode:"TriBand",primaryRadioID:"RADIO_2.4GHz"}],radioDefaults:[{radioID:"RADIO_2.4GHz",steeredModes:["TriBand"],settings:{mode:"802.11bgn",channel:6,channelWidth:"Standard"}},{radioID:"RADIO_5GHz",steeredModes:["Basic","TriBand"],settings:{mode:"802.11anac",channel:36,channelWidth:"Wide80"}},{radioID:"RADIO_5GHz_2",steeredModes:["Basic","TriBand"],settings:{mode:"802.11anac",channel:161,channelWidth:"Wide80"}}]}];var w=["WPA2/WPA3-Mixed-Personal","WPA-Mixed-Personal","WPA3-Personal","WPA2-Personal","WPA-Personal","WPA3-Enterprise","WPA2-Enterprise","WPA-Enterprise","WPA-Mixed-Enterprise","Enhanced-Open","Enhanced-Open-Only","Enhanced-Open+None","WEP","None"];function j(J,K,H){K=K||"";if(t.isServiceSupported("/wirelessap/WirelessAP4")){J=Number(J);var N=h.inArray(J,h.grep(H.supportedChannelsForChannelWidths,function(O){return O.channelWidth===K})[0].channels);return N!==-1}var G=H.supportedChannels.indexOf(J)>-1;var L=H.supportedWideChannels.indexOf(J)>-1;var F=!(K==="Auto"&&(!G||!L));var M=!(K==="Standard"&&!G);var I=!(y(K)&&!L);return F&&M&&I}function y(F){return F.indexOf("Wide")!==-1}function B(F){return F==="Wide80"||F.indexOf("Wide160")!==-1}function i(I,F){var G=F.band,J=F.supportedModes,H=false;if(J.indexOf("802.11mixed")!==-1){if(I==="802.11mixed"){H=true}}else{if(J.indexOf("802.11anac")!==-1&&J.indexOf("802.11anacax")===-1){if(I==="802.11bgn"){H=true}else{if(I==="802.11anac"){H=true}}}else{if(G==="2.4GHz"){if(J.indexOf("802.11bgnax")!==-1){if(I==="802.11bgnax"){H=true}}else{if(I==="802.11bgn"){H=true}}}else{if(G==="5GHz"){if(J.indexOf("802.11anacax")!==-1){if(I==="802.11anacax"){H=true}}else{if(I==="802.11an"){H=true}}}}}}return H}function E(){var F=D.find(d,function(G){return G.modelNumbers.indexOf(t.cache.data["/core/GetDeviceInfo"].output.modelNumber)!==-1});if(t.isServiceSupported("/wirelessap/bandsteering/AutoChannelConfiguration")){F.radioDefaults.forEach(function(G){G.settings.channel=0;G.settings.channelWidth="Auto"})}return F}function p(I,G){var F=E(),H=D.find(D.result(F,"supportedModes"),{mode:D.result(I,"bandSteeringMode")});return G.radioID===D.result(H,"primaryRadioID")}function e(F){return F.radioID.lastIndexOf("_2")===F.radioID.length-2}function s(){var G=t.Deferred(),H,F;t.send("/wirelessap/GetRadioInfo",{}).success(function(I){H=D.cloneDeep(I.output);H.radios=D.sortBy(H.radios,"radioID");if(H.supportedBandSteeringModes){F=E()}H.radios.forEach(function(J){J.isSetToMixedMode=i(J.settings.mode,J);J.supportedSecurityTypes=o(J.supportedSecurityTypes);if(F){J.bandSteeringSettings=D.find(F.radioDefaults,{radioID:J.radioID})||{}}});G.resolve(H)}).error(function(I){G.reject(I)});return G}function a(F){return{radioID:F.radioID,settings:F.settings}}function u(M,I,J){var N=t.Deferred(),H=D.cloneDeep(D.omit(M,q)),P=t.transaction(),G,F,O=[],L,K=false;H.radios.forEach(function(R,Q){if(H.isBandSteeringEnabled){if(D.includes(D.result(R,"bandSteeringSettings.steeredModes"),M.bandSteeringMode)){R.settings=D.merge(R.settings,R.bandSteeringSettings.settings);if(p(M,R)){F=a(R)}else{O.push(R.radioID)}}}if(!K&&t.isFeatureSupported("Node")&&D.isEmpty(R.supportedChannelsForChannelWidths)){K=true}H.radios[Q]=a(R)});if(!M.isBandSteeringEnabled){H=D.omit(H,"bandSteeringMode")}else{if(F&&O.length){O.forEach(function(Q){L=D.findIndex(H.radios,{radioID:Q});G=D.cloneDeep(H.radios[L]);H.radios[L]=D.merge(H.radios[L],F);H.radios[L].radioID=G.radioID;H.radios[L].settings.channel=G.settings.channel;H.radios[L].settings.mode=G.settings.mode;H.radios[L].settings.channelWidth=G.settings.channelWidth;if(!j(G.settings.channel,G.settings.channelWidth,M.radios[L])){H.radios[L].settings.channel=0}})}}P.add("/wirelessap/SetRadioSettings",H);v.guestAccess.checkAndConfigureGuestAccess(I,M,P);v.wps.checkAndDisableWPS(J.enabled,null,M,P);P.send({disableFeatureDetection:K}).success(function(){N.resolve(H)}).error(function(Q){N.reject(Q)});return N}function z(H,G){var F=H;if(G.supportedSecurityTypes.indexOf(H)===-1||["WPA2/WPA3-Mixed-Personal","WPA3-Personal"].indexOf(G.settings.security)!==-1){F=G.settings.security}return F}function m(F){return["WPA2-Personal","WPA2-Enterprise","WPA2/WPA3-Mixed-Personal","WPA3-Personal","WPA3-Enterprise"].indexOf(F)===-1}function c(H,J){var G=[],I,F;J=D.isEmpty(J)?"":J;if(H==="WEP-64"){F=Array.prototype.reduce.call(J,function(L,M,K){return L^=M.charCodeAt()<<K%4*8},0);D.range(0,4).forEach(function(){I="";D.range(0,5).forEach(function(){F*=214013;F+=2531011;F&=4294967295;I+=("0"+(F>>16&255).toString(16)).slice(-2).toUpperCase()});G.push(I)})}else{if(H==="WEP-128"){F=D.reduce(D.range(0,64),function(L,K){return L+J.charAt(K%J.length)},"");I=g(F).slice(0,26).toUpperCase();D.range(0,4).forEach(function(){G.push(I)})}else{throw'Unknown encryption specified. Needs to be "WEP-64" or "WEP-128"'}}return G}function o(F){return D.intersection(w,F)}function x(J,I){var F=v.time.routerTimeToDate(I),H=v.time.getDayFromSchedule(J.wirelessSchedule,F),G=F.getHours()*2;if(J.isWirelessSchedulerEnabled&&H[G]==="0"){return true}return false}function r(F,H){var G={channel:parseInt(F,10)};if(H){G.band=H}return D.find(C,G)||{}}function A(F){F=parseFloat(F).toPrecision(4);return D.find(C,{frequency:F})||{}}function l(){var F=t.Deferred();F.resolve();return F}function b(G){var F=false;if(D.find(G,{band:"6GHz"})){F=true}return F}function n(J,G){var I=D.union(f,G),F=D.cloneDeep(J)||[{}],H=D.omit(F[0].settings,I);F.shift();return F.every(function(K){return D.isEqual(H,D.omit(K.settings,I))})}function k(H){var F=false,G=t.isFeatureSupported("Node"),I=D.result(H,"radios",[]);if(G&&(b(I)||!n(I))){F=true}return F}return function(F){v=F;return{isMixedMode:i,isWideChannel:y,isWideChannel80or160:B,isChannelAndWidthSupported:j,isPrimaryBandSteeredRadio:p,isSecondaryBandRadio:e,isWirelessDisabledBySchedule:x,isWeakEncryptionType:m,checkForSSIDCollision:l,getWirelessSettings:s,setWirelessSettings:u,getBandSteeringSettings:E,getNodesPreferredSecurityType:z,generateWEPKeys:c,lookupChannelDataByChannel:r,lookupChannelDataByFrequency:A,getSecurityTypeOrder:o,has6GHzRadio:b,areMainRadioSettingsIdentical:n,shouldSplitNodesRadios:k}}}));