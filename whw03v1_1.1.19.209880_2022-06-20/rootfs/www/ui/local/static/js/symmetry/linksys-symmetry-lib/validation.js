(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","lodash","./symmetry-jnap","./symmetry-util"],b)}else{if(typeof module==="object"&&module.exports){module.exports=b(require("jquery"),require("lodash"),require("./symmetry-jnap"),require("./symmetry-util"))}else{a.validation=b(a.$,(a.lodash||a._),a.JNAP,a.symmetryUtil)}}}(this,function(i,v,q,s){var n={DHCP:{min:576,max:1500},Static:{min:576,max:1500},PPPoE:{min:576,max:1492},PPTP:{min:576,max:1460},L2TP:{min:576,max:1460}};var o=/[\x20-\x2F\x3A-\x40\x5B-\x60\x7B-\x7E]/;function g(z,y){var x=RegExp(y);return !z||x.test(z)}function d(z,y){var x=RegExp(y);return !z||!x.test(z)}function w(x){return function(y){return g(y,x)}}function p(z,A){if(!A||!A.guestPasswordRestrictions){return true}var y="";i.each(A.guestPasswordRestrictions.allowedCharacters,function(){y+="\\x"+this.lowCodepoint.toString(16).toUpperCase()+"-\\x"+this.highCodepoint.toString(16).toUpperCase()});var x=w("^["+y+"]+$");return x(z)}var m,l;m={minLength:function(y,x){return !y||y.length>=x},maxLength:function(y,x){y=y||"";return y.length<=x},rangeFirstPortValid:function(y,x){if(!x&&x!==0){return true}return l.max.fn(y,x)},rangeLastPortValid:function(x,y){if(!y&&y!==0){return true}return l.min.fn(x,y)},ipAddressHasFourOctets:function(x){return !x||x.split(".").length===4},ipAddressLocalTestSubnetMask:function(y,x){if(!y){return true}return c(y,x.ipAddress,x.subnetMask)},ipAddressLocalNotRouterIp:function(B,z){if(!B){return true}var x=B.split(".");var A=z.ipAddress.split(".");for(var y=0;y<4;y++){if(A[y]!==x[y]){return true}}return false},maxUsersValid:function(y,x){if(!y){return true}return y<=x.dhcpSettings.maxUsersLimit},wirelessSecurityTestMode:function(y,z){var x=z.settings.mode;if(s.wireless.isMixedMode(x,z)){return true}return !((x.indexOf("n")>-1||x.indexOf("ac")>-1)&&(y==="WEP"||y==="WPA-Mixed-Personal"||y==="WPA-Mixed-Enterprise"))},wirelessSecurityTestChannelWidth:function(y,z){var x=z.settings.channelWidth;return !(y==="WEP"&&s.wireless.isWideChannel(x))},networkModeTestSecurity:function(y,z){if(s.wireless.isMixedMode(y,z)){return true}var x=z.settings.security;y=y||"";return !((y.indexOf("n")>-1||y.indexOf("ac")>-1)&&(x==="WEP"||x==="WPA-Mixed-Personal"||x==="WPA-Mixed-Enterprise"))},networkModeTestChannelWidth:function(A,B){if(s.wireless.isMixedMode(A,B)){return true}A=A||"";var z=B.settings.channelWidth;var y=!(s.wireless.isWideChannel80or160(z)&&A.indexOf("ac")===-1);var x=!(A==="802.11a"&&s.wireless.isWideChannel(z));return y&&x},channelWidthTestSecurity:function(y,z){y=y||"";var x=z.settings.security;return !(s.wireless.isWideChannel(y)&&(x==="WEP"))},channelWidthTestMode:function(A,B){A=A||"";var z=B.settings.mode;var y=!(s.wireless.isWideChannel(A)&&(z==="802.11a"));var x=!(s.wireless.isWideChannel80or160(A)&&(z.indexOf("ac")===-1));return y&&x},channelWidthTestChannel:function(y,z){var x=z.settings.channel;return s.wireless.isChannelAndWidthSupported(x,y,z)},channelTestWidth:function(y,z){var x=z.settings.channelWidth;return !y||s.wireless.isChannelAndWidthSupported(y,x,z)},ssidTestNoCollision:function(z,A){var x=A.guestnetwork||{},y;if(x.isGuestNetworkEnabled){if(x.guestSSID){if(x.guestSSID===z){return false}}else{for(y=0;y<x.radios.length;y++){if(x.radios[y].isEnabled&&x.radios[y].guestSSID===z){return false}}}}return true},guestSsidTestNoCollision:function(A,x){var z=x.wirelessap||{radios:[]},y;for(y=0;y<z.radios.length;y++){if(z.radios[y].settings.ssid===A){return false}}return true},subnetMaskValid:function(A,z){var y=z?z.minNetworkPrefixLength:null,x=z?z.maxNetworkPrefixLength:null;if(!A){return true}return s.ip.isValidSubnetMask(A,y,x)},mtuValid:function(z,A){var y=parseInt(z,10),x=A.wanType;if(!z){return true}if(y===0||(y>=n[x].min&&y<=n[x].max)){return true}return false},macAddressValid:function(z){if(!z){return true}if(!/^(?:[0-9a-f]{2}[:-]?){5}(?:[0-9a-f]{2})$/i.test(z)){return false}if(z==="00:00:00:00:00:00"){return false}var A=z.substr(0,2),x=parseInt(A,16).toString(2);if(x.substr(x.length-1)==="1"){return false}var y=A.substr(A.length-1).toUpperCase();if(["0","2","4","6","8","A","C","E"].indexOf(y)===-1){return false}return true},vlanIDValid:function(y){if(!y){return true}var x=parseInt(y,10);if(x>=3&&x<=4095){return true}return false}};l={required:{fn:function(x){return Boolean(x)},message:"{{You must enter something to continue.}}",display:"onBlur"},min:{fn:function(y,x){return !y||parseFloat(y)>=x},message:"{{Must be {0} or greater.}}",display:"onBlur"},max:{fn:function(y,x){return !y||parseFloat(y)<=x},message:"{{Must be {0} or smaller.}}",display:"dynamic"},minLength:{fn:m.minLength,message:"{{Must be {0} characters or more.}}",display:"onBlur"},maxLength:{fn:m.maxLength,message:"{{Can't exceed {0} characters.}}",display:"dynamic"},pattern:{fn:function(y,x){return g(y,x)},message:"{{Invalid character.}}",display:"onBlur"},noSurroundWhitespace:{fn:function(x){return d(x,/^\s+|\s+$/)},message:"{{Can't start and/or end with a space.}}",display:"dynamic"},noSurroundDot:{fn:function(x){return d(x,/^\.+|\.+$/)},message:"{{Please enter a valid domain like: Facebook.com .}}",display:"onBlur"},integer:{fn:w(/^([0-9]+)$/),message:"{{Should be all numbers.}}",display:"dynamic"},macAddress:{fn:m.macAddressValid,message:'{{Must be twelve [0-9,a-f] characters only; ":" and "-" are optional.}}',display:"onBlur"},email:{fn:w(/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/),message:"{{Enter a complete email address.}}",display:"onBlur"},ascii:{fn:w(/^[\x20-\x7E]+$/),message:"{{Use letters, numbers, and common symbols.}}",display:"dynamic"},guestPasswordAllowedCharacters:{fn:p,message:"{{Use letters and numbers.}}",display:"dynamic"},hex:{fn:w(/^[0-9A-Fa-f]+$/),message:"{{Use numbers (0-9) and letters (a-f).}}",display:"dynamic"},rangeFirstPortValid:{fn:m.rangeFirstPortValid,message:"{{Beginning port number must be smaller or equal to ending port number.}}",display:"dynamic"},rangeLastPortValid:{fn:m.rangeLastPortValid,message:"{{Beginning port number must be smaller or equal to ending port number.}}",display:"dynamic"},ipAddressHasFourOctets:{fn:m.ipAddressHasFourOctets,message:"{{IP addresses are 4 octets separated by dots.}}",display:"onBlur"},ipAddress1stOctet:{fn:u(0,1,254),message:"{{First octet must be a number between 1-254.}}",display:"dynamic"},ipAddress1stOctetRouter:{fn:u(0,1,223),message:"{{First octet must be a number between 1-223.}}",display:"dynamic"},ipAddress2ndOctet:{fn:u(1),message:"{{Second octet must be a number between 0-255.}}",display:"dynamic"},ipAddress3rdOctet:{fn:u(2),message:"{{Third octet must be a number between 0-255.}}",display:"dynamic"},ipAddress4thOctet:{fn:u(3),message:"{{Fourth octet must be a number between 0-255.}}",display:"dynamic"},subnet1stOctet:{fn:u(0),message:"{{Invalid Subnet Mask.}}",display:"dynamic"},subnet2ndOctet:{fn:u(1),message:"{{Invalid Subnet Mask.}}",display:"dynamic"},subnet3rdOctet:{fn:u(2),message:"{{Invalid Subnet Mask.}}",display:"dynamic"},subnet4thOctet:{fn:u(3),message:"{{Invalid Subnet Mask.}}",display:"dynamic"},ipAddressNotReserved:{fn:function(x){return x!=="0.0.0.0"&&x!=="127.0.0.1"&&x!=="255.255.255.255"},message:"{{This IP address is already reserved.}}",display:"onBlur"},ipAddressPattern:{fn:w(/^\b(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\b/),message:"{{Invalid IP address.}}",display:"onBlur"},ipAddressLocalTestSubnetMask:{fn:m.ipAddressLocalTestSubnetMask,message:"{{This IP address is not in valid subnet.}}",display:"onBlur"},ipAddressLocalNotRouterIp:{fn:m.ipAddressLocalNotRouterIp,message:"{{Can't use router IP address.}}",display:"onBlur"},ssidTestNoCollision:{fn:m.ssidTestNoCollision,message:"{{Main network SSID cannot be the same as an active guest network SSID.}}",display:"onBlur"},guestSsidTestNoCollision:{fn:m.guestSsidTestNoCollision,message:"{{Guest network SSID cannot be the same as a main network SSID.}}",display:"onBlur"},domainCharsOnly:{fn:b([".."," ",":","/","?","#","[","]","@","!","$","&","'","(",")","*","+",",",";","="]),message:"{{Please enter a valid domain like: Facebook.com .}}",display:"onBlur"},dotRequired:{fn:function(x){return !x||x.indexOf(".")!==-1},message:"{{Please enter a valid domain like: Facebook.com .}}",display:"onBlur"},wirelessSecurityTestMode:{fn:m.wirelessSecurityTestMode,message:"{{Invalid when network mode is n or ac.}}",display:"onBlur"},wirelessSecurityTestChannelWidth:{fn:m.wirelessSecurityTestChannelWidth,message:"{{Invalid in wide channels.}}",display:"onBlur"},networkModeTestSecurity:{fn:m.networkModeTestSecurity,message:"{{Invalid when security type is WEP or WPA-Mixed.}}",display:"onBlur"},networkModeTestChannelWidth:{fn:m.networkModeTestChannelWidth,message:"{{Invalid for selected channel width.}}",display:"onBlur"},channelWidthTestSecurity:{fn:m.channelWidthTestSecurity,message:"{{Invalid when security type is WEP.}}",display:"onBlur"},channelWidthTestMode:{fn:m.channelWidthTestMode,message:"{{Invalid for selected network mode.}}",display:"onBlur"},channelWidthTestChannel:{fn:m.channelWidthTestChannel,message:"{{Not supported for selected channel.}}",display:"onBlur"},channelTestWidth:{fn:m.channelTestWidth,message:"{{Not supported for selected channel width.}}",display:"onBlur"},subnetMask:{fn:m.subnetMaskValid,message:"{{Invalid Subnet Mask.}}",display:"onBlur"},mtuValid:{fn:m.mtuValid,message:"{{MTU invalid for current WAN type.}}",display:"onBlur"},vlanIDValid:{fn:m.vlanIDValid,message:"{{Value is out of range (3-4095).}}",display:"onBlur"},maxUsersValid:{fn:m.maxUsersValid,message:"{{Invalid number of users.}}",display:"onBlur"},dynamicRange:{fn:function(B,A){if(!B){return true}var y=parseInt(B,10),z=A[0],x=A[1];return y>=z&&y<=x},message:"{{Value is out of range ({0}-{1}).}}",display:"dynamic"},smbUsernameValid:{fn:w(/^[a-zA-Z0-9\-_]+$/),message:"{{Username can include letters, numbers, -, and _.}}",display:"dynamic"},smbPasswordValid:{fn:w(/^[a-zA-Z0-9]+$/),message:"{{Password can include letters and numbers.}}",display:"dynamic"},hasUpperAndLowerCase:{fn:w(/[a-z].*[A-Z]|[A-Z].*[a-z]/),message:"{{Upper and lowercase letters}}",display:"dynamic"},hasAtLeastOneNumber:{fn:w(/\d/),message:"{{1 number}}",display:"dynamic"},hasPasswordSpecialCharacter:{fn:w(o),message:"{{1 special character}}",display:"dynamic"},noPasswordInvalidCharacters:{fn:function(y){var x=new RegExp("^"+o.source.replace("]","\\w]+$"));return g(y,x)},message:"{{Use a special character, such as !@#$%&*}}",display:"dynamic"},noConsecutiveCharacters:{fn:function(x){return d(x,/(.)\1/)},message:"{{Your password can't have the same character twice in a row}}",display:"dynamic"},noEmailInPassword:{fn:function(A){var y=v.result(A,"email",""),z=v.result(A,"password",""),x=new RegExp(v.escapeRegExp(y),"i");if(v.isEmpty(y)){return true}return d(z,x)},message:"{{Your password can't contain your email address}}",display:"dynamic"},noPasswordInHint:{fn:function(z){var A=v.result(z,"hint",""),y=v.result(z,"password",""),x=new RegExp(v.escapeRegExp(y),"i");if(v.isEmpty(y)){return true}return d(A,x)},message:"{{Your hint can't contain your password}}",display:"dynamic"}};l.blockedDomainMaxLength=j(l.maxLength,function(x){return x.maxRuleBlockedURLLength});l.guestPasswordMaxLength=j(l.maxLength,function(x){return x.guestPasswordRestrictions?x.guestPasswordRestrictions.maxLength:null});l.guestPasswordMinLength=j(l.minLength,function(x){return x.guestPasswordRestrictions?x.guestPasswordRestrictions.minLength:null});l.leaseTimeMax=j(l.max,function(x){return x.maxAllowedDHCPLeaseMinutes});l.leaseTimeMin=j(l.min,function(x){return x.minAllowedDHCPLeaseMinutes});l.firstPortValid=t("firstPort");l.lastPortValid=t("lastPort");l.firstExternalPortValid=t("firstExternalPort");l.lastExternalPortValid=t("lastExternalPort");l.firstTriggerPortValid=t("firstTriggerPort");l.lastTriggerPortValid=t("lastTriggerPort");l.firstForwardedPortValid=t("firstForwardedPort");l.lastForwardedPortValid=t("lastForwardedPort");var e={wepPassphraseRules:{maxLength:16,ascii:true},wepKey64:{required:true,hex:true,maxLength:10,minLength:10},wepKey128:{required:true,hex:true,maxLength:26,minLength:26},wpaPassphrase:{required:true,minLength:8,maxLength:63,noSurroundWhitespace:true,ascii:true},wpaPassphraseHex:{minLength:64,maxLength:64,noSurroundWhitespace:true,hex:true},radiusSharedKey:{required:true,ascii:true},cloudAccountLastName:{required:true,noSurroundWhitespace:true,minLength:1,maxLength:128},cloudAccountFirstName:{required:true,noSurroundWhitespace:true,minLength:1,maxLength:128},cloudAccountName:{required:true,minLength:7,maxLength:254,email:true,noSurroundWhitespace:true},cloudAccountPassword:{required:true,minLength:6,maxLength:128,ascii:true,noSurroundWhitespace:true},adminPassword:{required:true,maxLength:64,ascii:true,noSurroundWhitespace:true},applicationName:{required:true,noSurroundWhitespace:true},ipOctet:{min:0,max:255,integer:true},ipAddress:{noSurroundWhitespace:true,ipAddressHasFourOctets:true,ipAddress1stOctet:true,ipAddress2ndOctet:true,ipAddress3rdOctet:true,ipAddress4thOctet:true,ipAddressNotReserved:true,ipAddressPattern:true},ipAddressRouter:{noSurroundWhitespace:true,ipAddressHasFourOctets:true,ipAddress1stOctetRouter:true,ipAddress2ndOctet:true,ipAddress3rdOctet:true,ipAddress4thOctet:true,ipAddressNotReserved:true,ipAddressPattern:true},port:{required:true,integer:true,min:1,max:65535,maxLength:5},deviceName:{required:true,maxLength:255},maxIdleMinutes:{integer:true,min:1,max:9999,maxLength:4},reconnectAfterSeconds:{integer:true,min:20,max:180,maxLength:3},pppoeUsername:{required:true,maxLength:255,ascii:true,noSurroundWhitespace:true},pppoePassword:{maxLength:255,ascii:true},subnetMaskRequired:{required:true,subnetMask:true,ipAddressHasFourOctets:true,noSurroundWhitespace:true,subnet1stOctet:true,subnet2ndOctet:true,subnet3rdOctet:true,subnet4thOctet:true},macAddressRequired:{required:true,macAddress:true},vlanID:{maxLength:4,integer:true,vlanIDValid:true},smbUsername:{required:true,maxLength:20,smbUsernameValid:true},smbPassword:{required:true,minLength:4,maxLength:64,smbPasswordValid:true}};e.radiusServer=i.extend(true,{},e.ipAddress,{required:true});e.ipAddressRequired=i.extend(true,{},e.ipAddress,{required:true});var k={wirelessSecurity:function(x){return{wirelessSecurityTestMode:x,wirelessSecurityTestChannelWidth:x}},networkMode:function(x){return{networkModeTestSecurity:x,networkModeTestChannelWidth:x}},channelWidth:function(x){return{channelWidthTestMode:x,channelWidthTestChannel:x,channelWidthTestSecurity:x}},channel:function(x){return{channelTestWidth:x}},ssid:function(x){return{required:true,noSurroundWhitespace:true,ssidTestNoCollision:x}},guestSsid:function(x){return{required:true,noSurroundWhitespace:true,guestSsidTestNoCollision:x}},guestPassword:function(x){return{required:true,guestPasswordMaxLength:x,guestPasswordMinLength:x,guestPasswordAllowedCharacters:x}},rangeFirstPort:function(x){return i.extend(true,{},e.port,{rangeFirstPortValid:x})},rangeLastPort:function(x){return i.extend(true,{},e.port,{rangeLastPortValid:x})},ipAddressLocal:function(x){return i.extend(true,{},e.ipAddress,{ipAddressLocalTestSubnetMask:x,ipAddressLocalNotRouterIp:x})},lanSettingsIpAddress:function(x){return i.extend(true,{},e.ipAddressRouter,{required:true,ipAddressLocalTestSubnetMask:x})},maxUsers:function(x){return{required:true,integer:true,min:1,maxUsersValid:x}},leaseTime:function(x){return{required:true,integer:true,leaseTimeMax:x,leaseTimeMin:x}},blockedDomain:function(x){return{blockedDomainMaxLength:x,noSurroundDot:true,domainCharsOnly:true,dotRequired:true}},requiredDomain:function(x){return{required:true,maxLength:x,noSurroundDot:true,domainCharsOnly:true,dotRequired:true}},mtu:function(x){return{integer:true,mtuValid:x}},cloudAccountCreateNewPassword:function(x){return{required:true,minLength:10,maxLength:128,noSurroundWhitespace:true,hasUpperAndLowerCase:x,hasAtLeastOneNumber:x,hasPasswordSpecialCharacter:x,noPasswordInvalidCharacters:x,noConsecutiveCharacters:x}},adminPassword:function(x){return{required:true,minLength:10,maxLength:64,noSurroundWhitespace:true,hasUpperAndLowerCase:x,hasAtLeastOneNumber:x,hasPasswordSpecialCharacter:x,noPasswordInvalidCharacters:x,noConsecutiveCharacters:x}}};k.firstPort=h("firstPort");k.lastPort=h("lastPort");k.firstExternalPort=h("firstExternalPort");k.lastExternalPort=h("lastExternalPort");k.firstTriggerPort=h("firstTriggerPort");k.lastTriggerPort=h("lastTriggerPort");k.firstForwardedPort=h("firstForwardedPort");k.lastForwardedPort=h("lastForwardedPort");function u(y,z,x){z=z||0;x=x||255;return function(B){if(!B){return true}var A=B.split(".");if(A.length<=y){return true}if(!A[y]){return A.length===y+1}return l.integer.fn(A[y])&&l.min.fn(A[y],z)&&l.max.fn(A[y],x)}}function f(A,x){var z=(A&x)>>>0,y=(~x|z)>>>0;return A!==z&&A!==y}function c(z,C,B){var y=s.ip.ipToNum(z),D=s.ip.ipToNum(C),A=s.ip.ipToNum(B),x=(y&A)>>>0,E=(D&A)>>>0;return(x===E)&&f(y,A)}function b(x){return function(z){var y;if(!z){return true}z=s.parentalControls.trimBlockedDomain(z);for(y=0;y<x.length;y++){if(z.indexOf(x[y])!==-1){return false}}return true}}function j(y,x){return i.extend(true,{},y,{fn:function(A,z){return y.fn(A,x(z)||"")},message:function(z){return s.stringFormat(y.message,x(z))}})}function t(y){var x,z;if(y.indexOf("first")>-1){x=l.rangeFirstPortValid;z=y.replace("first","last")}else{if(y.indexOf("last")>-1){x=l.rangeLastPortValid;z=y.replace("last","first")}else{throw"incorrect port range field"}}return j(x,function(A){return A[z]})}function h(x){return function(y){var z={};z[x+"Valid"]=y;return i.extend(true,{},e.port,z)}}function a(y,z){var A=y,x=true;if(v.isFunction(y)){A=y(z)}v.forEach(A,function(C,B){x=l[B].fn(z,C);return x});return x}var r={rule:l,ruleSet:e,ruleSetInterop:k,checkRuleSet:a};return r}));