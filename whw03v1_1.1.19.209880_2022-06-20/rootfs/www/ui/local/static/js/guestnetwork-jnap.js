window.RAINIER=window.RAINIER||{};RAINIER.applets=RAINIER.applets||{};RAINIER.applets.guestNetwork=(function(){function b(g){var h=RAINIER.network.isGuestNetwork3Supported();if(!h){g.canEnableGuestNetwork=g.radio.band24.isEnabled}else{g.canEnableGuestNetwork=g.radio.band24.canEnableRadio||g.radio.band50.canEnableRadio||(!_.isEmpty(g.radio.band60)&&g.radio.band60.canEnableRadio)}}function a(h,g,i){var k=RAINIER.jnapActions.getGuestRadioSettings();var j={action:k,data:{},cb:function(l){if(l){if(l.result==="OK"){h=l.output;h.radio={};if(RAINIER.network.isGuestNetwork3Supported()){$.each(h.radios,function(){switch(this.radioID){case"RADIO_2.4GHz":h.radio.band24=this;break;case"RADIO_5GHz":h.radio.band50=this;break;case"RADIO_6GHz":h.radio.band60=this;break}})}else{h.radio.band24={radioID:"RADIO_2.4GHz",isEnabled:h.isGuestNetworkEnabled,broadcastGuestSSID:h.broadcastGuestSSID,guestSSID:h.guestSSID,guestPassword:h.guestPassword,canEnableRadio:h.canEnableRadio}}b(h);if(typeof g==="function"){g(h)}}else{console.warn(k+' : result is not "OK".',l)}}else{}}};if(i){i.add(j)}else{RAINIER.jnap.send(j)}}function e(g,l,r,p,q){var m=RAINIER.jnapActions.setGuestRadioSettings(),o=RAINIER.network.isBehindNode(),k=symmetryUtil.guestAccess.isCaptivePortal(g),j,h;var n={isGuestNetworkEnabled:g.isGuestNetworkEnabled,maxSimultaneousGuests:parseInt(g.maxSimultaneousGuests,10),guestSSID:g.radio.band24.guestSSID,guestPassword:g.radio.band24.guestPassword,broadcastGuestSSID:g.isGuestNetworkEnabled};if(!k){$.delAttr(n,"maxSimultaneousGuests")}p=!!p;q=!!q;if(RAINIER.network.isGuestNetwork3Supported()){$.delAttr(n,["guestSSID","guestPassword","broadcastGuestSSID","canEnableGuestNetwork"]);n.radios=[];if(g.radio.band24){if(o){j={isEnabled:g.isGuestNetworkEnabled,broadcastGuestSSID:g.isGuestNetworkEnabled,guestSSID:g.radio.band24.guestSSID,guestWPAPassphrase:g.radio.band24.guestWPAPassphrase};_.each(g.radio,function(s){h=_.clone(j);h.radioID=s.radioID;if(!k){h.isEnabled=g.isGuestNetworkEnabled&&s.canEnableRadio}n.radios.push(h)})}else{j={isEnabled:g.radio.band24.isEnabled,broadcastGuestSSID:g.radio.band24.isEnabled,guestSSID:g.radio.band24.guestSSID,guestPassword:g.radio.band24.guestPassword};h=_.clone(j);h.radioID="RADIO_2.4GHz";n.radios.push(h);if(g.radio.band50){h=_.clone(j);h.radioID="RADIO_5GHz";h.isEnabled=g.radio.band50.isEnabled;h.broadcastGuestSSID=g.radio.band50.isEnabled;h.guestSSID=g.radio.band50.guestSSID;n.radios.push(h)}}}}var i={action:m,data:n,cb:function(s){if(!p){RAINIER.ui.hideWaiting()}if(s){if(s.result==="OK"){if(o||!RAINIER.network.isGuestNetwork3Supported()){g.radio.band24.isEnabled=g.isGuestNetworkEnabled}b(g);RAINIER.event.fire("guestNetwork.updated",g)}else{console.warn(m+' : result is not "OK".',s)}}else{}if(typeof l==="function"){l(s)}}};if(!p){RAINIER.ui.showWaiting()}if(q){i.disableDefaultAjaxErrHandler=true;i.disableDefaultRebootErrHandler=true}if(r){r.add(i)}else{RAINIER.jnap.send(i)}}function d(h,k){var j=false,g=RAINIER.network.isBehindNode();k=_.compact(k);function i(l,m){return(l.settings&&l.settings.ssid===m)}if(h.isGuestNetworkEnabled){$.each(k,function(m,l){$.each(h.radio,function(o,n){if(!g&&h.radio.band24&&!h.radio.band50){n.isEnabled=h.isGuestNetworkEnabled}else{if(g&&l.radioID===n.radioID){n.isEnabled=l.settings.isEnabled}}if(!j&&n.isEnabled){j=i(l,n.guestSSID)}if(j){return false}});if(j){return false}})}return j}function f(h,g){var i=symmetryUtil.guestAccess.isCaptivePortal(h.guestSettings);return(!!h.guestSettings.radio.band24&&(g.guestSettings.radio.band24.isEnabled!==h.guestSettings.radio.band24.isEnabled||g.guestSettings.radio.band24.guestSSID!==h.guestSettings.radio.band24.guestSSID||(i&&g.guestSettings.radio.band24.guestPassword!==h.guestSettings.radio.band24.guestPassword)||(!i&&g.guestSettings.radio.band24.guestWPAPassphrase!==h.guestSettings.radio.band24.guestWPAPassphrase)))}function c(h,g){return(!!h.guestSettings.radio.band50&&(g.guestSettings.radio.band50.isEnabled!==h.guestSettings.radio.band50.isEnabled||g.guestSettings.radio.band50.guestSSID!==h.guestSettings.radio.band50.guestSSID))}return{getSettings:a,setSettings:e,isGuestSSIDConflict:d,isBand24Changing:f,isBand50Changing:c,updateCanEnableGuestNetwork:b}}());